<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!-- Basic -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Site Metas -->
    <title>Jimbung Industrial - Ecommerce Bootstrap 4 HTML Template</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link th:href="@{/assets/img/jimbung.png}" rel="icon">
    <link th:href="@{/assets/img/apple-touch-icon_1.png}" rel="apple-touch-icon">

    <!-- Bootstrap CSS -->
    <link th:href="@{/assets/css/bootstrap.min.css}" rel="stylesheet">
    <!-- Site CSS -->
    <link href="/assets/css/style_1.css" rel="stylesheet">
    <!-- Responsive CSS -->
    <link th:href="@{/assets/css/responsive.css}" rel="stylesheet">
    <!-- Custom CSS -->
    <link th:href="@{/assets/css/custom.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/assets/css/loader.css}">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        /* Center the modal */
        .modal {
            text-align: center;
            padding: 0 !important;
        }

        .modal-dialog {
            display: inline-block;
            text-align: left;
            vertical-align: middle;
        }

        .modal-title {
            text-align: center;
        }

        /* Style for the modal content */
        .modal-content {
            font-weight: bold;
            color: black;
            /* Text color */
        }

        /* Style for the close button */
        .modal-header .close {
            font-size: 1.5rem;
        }

        /* Style for the form elements inside the modal body */
        .modal-body {
            text-align: center;
            /* Center-align the content in the modal body */
            width: 500px;
        }

        .modal-body label {
            font-weight: bold;
        }

        /* Style for the quantity input */
        #quantity {
            margin-bottom: 10px;
            /* Add space below the quantity input */
        }

        /* Style for the Add to Cart button */
        .modal-body button {
            display: block;
            /* Display the button as a block element (full width) */
            margin: 0 auto;
            /* Center the button horizontally */
            margin-top: 10px;
            /* Add space above the button */
        }

        /* Style for the form elements inside the modal body */
        .modal-body label {
            font-weight: bold;
        }

        /* Style for the Quantity input */
        .modal-body #quantity {
            margin-bottom: 10px;
            /* Add space below the quantity input */
        }

        /* Style for the Add to Cart button */
        .modal-body button {
            display: block;
            /* Display the button as a block element (full width) */
            margin: 0 auto;
            /* Center the button horizontally */
            margin-top: 10px;
            /* Add space above the button */
        }
    </style>

</head>

<body>
    <div th:replace="user/fragments/loader :: loader"></div>
    <!-- Start Main Top -->
    <div th:replace="user/fragments/user-header :: header"></div>
    <!-- End Main Top -->

    <!-- Start Top Search -->
    <div class="top-search">
        <div class="container">
            <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-search"></i></span>
                <input type="text" class="form-control" placeholder="Search" id="search">
                <span class="input-group-addon close-search"><i class="fa fa-times"></i></span>
            </div>
        </div>
    </div>
    <!-- End Top Search -->

    <!-- Start All Title Box -->
    <div class="all-title-box">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>Shop</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>
                        <li class="breadcrumb-item active">Shop</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End All Title Box -->

    <!-- Start Shop Page  -->
    <div class="shop-box-inner">
        <div class="container">
            <div class="row">
                <div class="col-xl-3 col-lg-3 col-sm-12 col-xs-12 sidebar-shop-left">
                    <div class="product-categori">
                        <div class="filter-sidebar-left">
                            <div class="title-left">
                                <h3>Kategori</h3>
                            </div>
                            <div class="list-group list-group-collapse list-group-sm list-group-tree"
                                id="list-group-men" data-children=".sub-men">
                                <!-- <a class="list-group-item list-group-item-action" th:href="@{/user/shop/}"
                                    data-toggle="collapse" aria-expanded="true"
                                    th:text="Semua Produk"> <small class="text-muted">
                                </a> -->
                                <div class="list-group-collapse sub-men" th:each="category : ${categories}">
                                    <a class="list-group-item list-group-item-action" href="#sub-men1"
                                        data-toggle="collapse" aria-expanded="true" aria-controls="sub-men1"
                                        th:text="${category.name}"> <small class="text-muted"></small>
                                    </a>
                                    <div class="collapse show" id="sub-men1" data-parent="#list-group-men">
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action active"
                                                th:each="subcategory : ${subcategories}"
                                                th:if="${subcategory.category.id == category.id}"
                                                th:href="@{'/user/shop/' + ${subcategory.id}}"
                                                th:text="${subcategory.name}"> <small
                                                    class="text-muted"></small></a>
                                        </div>
                                    </div>
                                </div>                                
                            </div>
                        </div>
                        <div class="filter-price-left">
                            <div class="price-box-slider">
                                <div id="slider-range"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-9 col-lg-9 col-sm-12 col-xs-12 shop-content-right">
                    <div class="right-product-box">

                        <div class="row product-categorie-box">
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane fade show active" id="grid-view">
                                    <p th:if="${#lists.isEmpty(products)}" style="text-align: center; font-weight: bold;">Produk tidak tersedia</p>
                                    <div class="row">
                                    
                                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-4" th:each="product : ${products}">
                                            <div class="products-single fix">
                                                
                                                <div class="box-img-hover">
                                                    <div class="type-lb">
                                                        <p class="sale">Sale</p>
                                                    </div>
                                                    <div th:each="image, iterStat : ${product.image}" th:if="${iterStat.index == 0}">
                                                        <img class="img-fluid" th:src="@{${image.url}}" alt="Product Image" style="height: 200px; width: auto; display: block; margin-left: auto; margin-right: auto;"/>

                                                    </div>
                                                    <div class="mask-icon">
                                                        <ul>
                                                            <li><a th:href="@{'/user/shop-detail/' + ${product.id}}" data-toggle="tooltip" data-placement="right" title="View"><i class="fas fa-eye"></i></a></li>
                                                        </ul>
                                                        <a href="#" class="cart" data-toggle="modal" th:data-target="'#modal-' + ${product.id}">Add to Cart</a>
                                                    </div>
                                                </div>
                                                
                                                
                                                <!-- Modal -->
                                                        <div class="modal fade" th:id="'modal-' + ${product.id}" tabindex="-1" role="dialog">
                                                          <div class="modal-dialog">
                                                            <div class="modal-content">
                                                              <div class="modal-header">
                                                                <h5 class="modal-title" th:text="${product.name}"></h5>
                                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                              </div>
                                                                <div class="modal-body">
                                                                    <!-- Form for Add to Cart -->
                                                                    <form th:action="@{'/user/products/addToCart/' + ${product.id}}" method="post">
                                                                        <input type="hidden" name="productId" th:value="${product.id}" />
                                                                        <div  class="form-group size-st">
                                                                        <label class="size-label">Size</label>
                                                                        <select id="sizeSelect-${product.id}" name="size" class="selectpicker show-tick form-control" required>
                                                                            <option value="">Size</option>
                                                                            <option value="S">S</option>
                                                                            <option value="M">M</option>
                                                                            <option value="L">L</option>
                                                                            <option value="XL">XL</option>
                                                                            <option value="XXL">XXL</option>
                                                                            <option value="3XL">3XL</option>
                                                                            <option value="4XL">4XL</option>
                                                                        </select>
                                                                        </div>
                                                                        <br>
                                                                        <div class="form-group quantity-box">
                                                                            <label  class="control-label" for="buyNowQuantity-${product.id}">Quantity:</label>
                                                                            <input class="form-control" type="number" id="buyNowQuantity-${product.id}" name="quantity" min="1" th:max="${product.stock}" required>
                                                                        </div>
                                                                        <button type="submit" class="btn btn-primary mt-2" style="background-color: #8F1D14;">Add to Cart</button>
                                                                    </form>
                                                                    <!-- Form for Buy Now -->
                                                                    <!-- <form th:action="@{'/user/products/buyToCart/' + ${product.id}}" method="post">
                                                                        <input type="hidden" name="productId" th:value="${product.id}" />
                                                                        <input type="hidden" name="quantity" id="buyNowQuantity-${product.id}" value="1"/> 
                                                                        <input type="hidden" name="size" id="buyNowSize-${product.id}" />
                                                                        <div style="display: flex; align-items: center;">
                                                                            <button type="submit" class="btn btn-success mt-2">Buy Now</button>
                                                                        </div>
                                                                    </form> -->
                                                                </div>
                                                            </div>
                                                          </div>
                                                        </div>
                                                <div class="why-text">
                                                    <h4 th:text="${product.name}"></h4>
                                                    <small>Start From </small>
                                                    <h5 th:text="${product.amountFormatted}"></h5>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Shop Page -->
    <div th:replace="user/fragments/footer :: footer"></div>

    <a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>

    <!-- ALL JS FILES -->
    <script th:src="@{/assets/js/jquery-3.2.1.min.js}"></script>
    <script th:src="@{/assets/js/popper.min.js}"></script>
    <script th:src="@{/assets/js/bootstrap.min.js}"></script>
    <!-- ALL PLUGINS -->
    <script th:src="@{/assets/js/jquery.superslides.min.js}"></script>
    <script th:src="@{/assets/js/bootstrap-select.js}"></script>
    <script th:src="@{/assets/js/inewsticker.js}"></script>
    <script th:src="@{/assets/js/bootsnav.js}"></script>
    <script th:src="@{/assets/js/images-loded.min.js}"></script>
    <script th:src="@{/assets/js/isotope.min.js}"></script>
    <script th:src="@{/assets/js/owl.carousel.min.js}"></script>
    <script th:src="@{/assets/js/baguetteBox.min.js}"></script>
    <script th:src="@{/assets/js/form-validator.min.js}"></script>
    <script th:src="@{/assets/js/contact-form-script.js}"></script>
    <script th:src="@{/assets/js/custom.js}"></script>
    <script th:src="@{/assets/js/loader.js}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // This script will listen for changes on all size selects and update the corresponding hidden inputs
            var sizeSelects = document.querySelectorAll('[id^="sizeSelect-"]');
            sizeSelects.forEach(function(select) {
                select.addEventListener('change', function() {
                    var productId = this.id.split('-')[1];
                    var selectedSize = this.value;
                    var correspondingHiddenInput = document.getElementById('buyNowSize-' + productId);
                    if (correspondingHiddenInput) {
                        correspondingHiddenInput.value = selectedSize;
                    }
                });
            });
        });
    </script>

</body>

</html>